<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compute Mahalanobis Distance and Flag Multivariate Outliers — mahalanobis_distance • rstatix</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Compute Mahalanobis Distance and Flag Multivariate Outliers — mahalanobis_distance" />

<meta property="og:description" content="Pipe-friendly wrapper around to the function
 mahalanobis(), which returns the squared
 Mahalanobis distance of all rows in x. Compared to the base function, it
 automatically flags multivariate outliers.
Mahalanobis distance is a common metric used to identify multivariate
 outliers. The larger the value of Mahalanobis distance, the more unusual the
 data point (i.e., the more likely it is to be a multivariate outlier).
The distance tells us how far an observation is from the center of the cloud, taking into
 account the shape (covariance) of the cloud as well.
To detect outliers, the calculated Mahalanobis distance is compared against
 a chi-square (X^2) distribution with degrees of freedom equal to the number
 of dependent (outcome) variables and an alpha level of 0.001.
The threshold to declare a multivariate outlier is determined using the
 function qchisq(0.999, df) , where df is the degree of freedom (i.e.,
 the number of dependent variable used in the computation)." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rstatix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute Mahalanobis Distance and Flag Multivariate Outliers</h1>
    
    <div class="hidden name"><code>mahalanobis_distance.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Pipe-friendly wrapper around to the function
 <code><a href='https://www.rdocumentation.org/packages/stats/topics/mahalanobis'>mahalanobis</a>()</code>, which returns the squared
 Mahalanobis distance of all rows in x. Compared to the base function, it
 automatically flags multivariate outliers.</p>
<p>Mahalanobis distance is a common metric used to identify multivariate
 outliers. The larger the value of Mahalanobis distance, the more unusual the
 data point (i.e., the more likely it is to be a multivariate outlier).</p>
<p>The distance tells us how far an observation is from the center of the cloud, taking into
 account the shape (covariance) of the cloud as well.</p>
<p>To detect outliers, the calculated Mahalanobis distance is compared against
 a chi-square (X^2) distribution with degrees of freedom equal to the number
 of dependent (outcome) variables and an alpha level of 0.001.</p>
<p>The threshold to declare a multivariate outlier is determined using the
 function <code><a href='https://www.rdocumentation.org/packages/stats/topics/Chisquare'>qchisq(0.999, df) </a></code>, where df is the degree of freedom (i.e.,
 the number of dependent variable used in the computation).</p>
    
    </div>

    <pre class="usage"><span class='fu'>mahalanobis_distance</span>(<span class='no'>data</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>a data frame. Columns are variables.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>One unquoted expressions (or variable name). Used to select a
variable of interest. Can be also used to ignore a variable that are not
needed for the computation. For example specify <code>-id</code> to ignore the id
column.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns the input data frame with two additional columns: 1)
 "mahal.dist": Mahalanobis distance values; and 2) "is.outlier": logical
 values specifying whether a given observation is a multivariate outlier</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Compute mahalonobis distance and flag outliers if any</span>
<span class='no'>iris</span> <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='doo.html'>doo</a></span>(~<span class='fu'>mahalanobis_distance</span>(<span class='no'>.</span>))</div><div class='output co'>#&gt; <span class='warning'>Warning: `...` must not be empty for ungrouped data frames.</span>
#&gt; <span class='warning'>Did you want `data = everything()`?</span></div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 150 x 6</span><span>
#&gt;    Sepal.Length Sepal.Width Petal.Length Petal.Width mahal.dist is.outlier
#&gt;           </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>       </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>        </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>       </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>      </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;lgl&gt;</span><span>     
#&gt; </span><span style='color: #555555;'> 1</span><span>          5.1         3.5          1.4         0.2       2.13 FALSE     
#&gt; </span><span style='color: #555555;'> 2</span><span>          4.9         3            1.4         0.2       2.85 FALSE     
#&gt; </span><span style='color: #555555;'> 3</span><span>          4.7         3.2          1.3         0.2       2.08 FALSE     
#&gt; </span><span style='color: #555555;'> 4</span><span>          4.6         3.1          1.5         0.2       2.45 FALSE     
#&gt; </span><span style='color: #555555;'> 5</span><span>          5           3.6          1.4         0.2       2.46 FALSE     
#&gt; </span><span style='color: #555555;'> 6</span><span>          5.4         3.9          1.7         0.4       3.88 FALSE     
#&gt; </span><span style='color: #555555;'> 7</span><span>          4.6         3.4          1.4         0.3       2.86 FALSE     
#&gt; </span><span style='color: #555555;'> 8</span><span>          5           3.4          1.5         0.2       1.83 FALSE     
#&gt; </span><span style='color: #555555;'> 9</span><span>          4.4         2.9          1.4         0.2       3.38 FALSE     
#&gt; </span><span style='color: #555555;'>10</span><span>          4.9         3.1          1.5         0.1       2.38 FALSE     
#&gt; </span><span style='color: #555555;'># … with 140 more rows</span><span></div><div class='input'>
<span class='co'># Compute distance by groups and filter outliers</span>
<span class='no'>iris</span> <span class='kw'>%&gt;%</span>
 <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>Species</span>) <span class='kw'>%&gt;%</span>
 <span class='fu'><a href='doo.html'>doo</a></span>(~<span class='fu'>mahalanobis_distance</span>(<span class='no'>.</span>)) <span class='kw'>%&gt;%</span>
 <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>is.outlier</span> <span class='kw'>==</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 0 x 7</span><span>
#&gt; </span><span style='color: #555555;'># … with 7 variables: Species </span><span style='color: #555555;font-style: italic;'>&lt;fct&gt;</span><span style='color: #555555;'>, Sepal.Length </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, Sepal.Width </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>,
#&gt; #   Petal.Length </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, Petal.Width </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, mahal.dist </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span style='color: #555555;'>, is.outlier </span><span style='color: #555555;font-style: italic;'>&lt;lgl&gt;</span><span></div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Alboukadel Kassambara.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

